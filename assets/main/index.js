window.__require=function t(e,o,n){function i(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(r)return r(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var p=o[c]={exports:{}};e[c][0].call(p.exports,function(t){return i(e[c][1][t]||t)},p,p.exports,t,e,o,n)}return o[c].exports}for(var r="function"==typeof __require&&__require,c=0;c<n.length;c++)i(n[c]);return i}({AdManager:[function(t,e){"use strict";cc._RF.push(e,"8d515YP+RtP2KXVOZDa0utO","AdManager"),cc.Class({extends:cc.Component,properties:{androidLink:{default:""},iosLink:{default:""},defaultLink:{default:""}},openAdUrl:function(){window.androidLink=this.androidLink,window.iosLink=this.iosLink,window.defaultLink=this.defaultLink,window.openAdUrl?window.openAdUrl():window.open()}}),cc._RF.pop()},{}],Constant:[function(t,e,o){"use strict";cc._RF.push(e,"12675ebrGVK4a80DqpA3dOi","Constant"),Object.defineProperty(o,"__esModule",{value:!0}),o.Constant=o.ELEMENT=void 0,o.ELEMENT={ABYSS:"abyss",DARK:"dark",FIRE:"fire",LIGHT:"light",NATURE:"nature",WATER:"water"},o.Constant={EVENT:{ENEMY_DIE:"ENEMY_DIE",END_GAME:"END_GAME",CHANGE_SPEED:"CHANGE_SPEED",HURT_EFFECT:"HURT_EFFECT"}},cc._RF.pop()},{}],PlatformBrandIcon:[function(t,e,o){"use strict";cc._RF.push(e,"5c2b0Hn/WBGxbjDSZRcovbN","PlatformBrandIcon");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.androidIcon=null,e.iosIcon=null,e}return i(e,t),e.prototype.start=function(){cc.sys.os==cc.sys.OS_ANDROID?this.getComponent(cc.Sprite).spriteFrame=this.androidIcon:cc.sys.os==cc.sys.OS_IOS&&(this.getComponent(cc.Sprite).spriteFrame=this.iosIcon)},r([s(cc.SpriteFrame)],e.prototype,"androidIcon",void 0),r([s(cc.SpriteFrame)],e.prototype,"iosIcon",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],bulletHeroListener:[function(t,e,o){"use strict";cc._RF.push(e,"975e9qXd7NFWq/hUX7qaeWA","bulletHeroListener");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.damage=0,e.isSkill4=!1,e}return i(e,t),e.prototype.start=function(){},e.prototype.setDame=function(t){this.damage=t},e.prototype.onCollisionEnter=function(t,e){var o=cc.Canvas.instance.node.getComponent("game").towerComp;t.node.getComponent("enemyListener")&&e.node.getComponent("bulletHeroListener")&&(t.node.getComponent("enemyListener").target.getComponent("enemy").attacked(this.damage),"towerBullet"!=e.node.name||this.isSkill4||(1==o.upgrade4&&o.skill4(this.node,this.node.position),e.node.getComponent(cc.CircleCollider).enabled=!1,this.scheduleOnce(function(){e.node.stopAllActions(),e.node.getChildByName("explode").active=!0,e.node.getChildByName("trail1").active=!1,e.node.getChildByName("icon").active=!1},.01),this.scheduleOnce(function(){e.node.destroy()},.12)),"spider"==e.node.name&&(e.node.children[0].getComponent(sp.Skeleton).setAnimation(0,"die",!1),e.node.stopAllActions(),this.scheduleOnce(function(){e.node.destroy()},.2)))},r([s(cc.Integer)],e.prototype,"damage",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],destinationListener:[function(t,e,o){"use strict";cc._RF.push(e,"5435exKNjFE8IZaWUAfA9XP","destinationListener");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.onCollisionEnter=function(){},r([s(cc.Node)],e.prototype,"target",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],effect:[function(t,e,o){"use strict";cc._RF.push(e,"dd0ea+BMfVDHq0Z2GJe3K85","effect");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.anim=null,e.gamePlay=null,e.type=null,e}return i(e,t),e.prototype.start=function(){this.gamePlay=cc.Canvas.instance.node.getComponent("game")},e.prototype.setAnim=function(){},e.prototype.finish=function(){this.node.destroy()},e.prototype.play=function(t,e){switch(void 0===e&&(e=cc.v3(0,0)),t){case"moon_aura":this.getAnim(t).speed=.4,this.node.position=e,this.node.scale=2;break;case"skill_1_boss":this.getAnim(t).speed=.3,this.node.position=e;break;case"skill1_fx":this.getAnim(t).speed=.5,this.node.angle=90,this.node.position=e}this.anim.play(t)},e.prototype.getAnim=function(t){for(var e=0;e<this.anim.getClips().length;e++)if(this.anim.getClips()[e].name==t)return this.anim.getClips()[e];return null},r([s(cc.Animation)],e.prototype,"anim",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],enemyListener:[function(t,e,o){"use strict";cc._RF.push(e,"6c406yY23xPV536A6lXzbY6","enemyListener");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.onCollisionEnter=function(t,e){e.node.getComponent("enemyListener")&&t.node.getComponent("towerListener")&&e.node.getComponent("enemyListener").target.getComponent("enemy").attack(t.node),e.node.getComponent("enemyListener")&&t.node.getComponent("destinationListener")&&e.node.getComponent("enemyListener").target.destroy()},r([s(cc.Node)],e.prototype,"target",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],enemy:[function(t,e,o){"use strict";cc._RF.push(e,"5d463bd0DZDaLUJ1AjC1qoB","enemy");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Constant"),a=cc._decorator,s=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bodySkeleton=null,e.bodyCollider=null,e.blood=null,e.hp=0,e.damage=0,e.speed=50,e.isDie=!1,e.maxHp=0,e.gamePlay=null,e}return i(e,t),e.prototype.onLoad=function(){},e.prototype.start=function(){this.addEventCompleteSpine(),this.maxHp=this.hp,this.gamePlay=cc.Canvas.instance.node.getComponent("game")},e.prototype.run=function(){this.bodySkeleton.setAnimation(0,"move",!0);var t=this.node.position.mag()/this.speed;cc.tween(this.node).to(t,{position:cc.v3(0,0)}).start()},e.prototype.attacked=function(t){var e=this;this.isDie||(this.hp-=t,this.hp<=0&&(this.hp=0,this.bodyCollider.enabled=!1,this.isDie=!0,this.node.stopAllActions(),this.bodySkeleton.setAnimation(0,"die",!1),this.blood.scheduleOnce(function(){e.blood.node.parent.active=!1},.15)),this.blood.fillRange=this.hp/this.maxHp)},e.prototype.attack=function(t){var e=this,o=t.getComponent("tower");this.node.stopAllActions(),this.bodySkeleton.setAnimation(0,"attack_melee_1",!0),this.bodySkeleton.setEventListener(function(){o.attacked(e.damage)})},e.prototype.addEventCompleteSpine=function(){var t=this;this.bodySkeleton.setCompleteListener(function(e){var o=e.animation?e.animation.name:"";"die"==o&&(cc.Canvas.instance.node.emit(c.Constant.EVENT.ENEMY_DIE),t.node.destroy()),"attack_melee_1"==o&&t.gamePlay.isEndGame&&t.run()})},r([l(sp.Skeleton)],e.prototype,"bodySkeleton",void 0),r([l(cc.CircleCollider)],e.prototype,"bodyCollider",void 0),r([l(cc.Sprite)],e.prototype,"blood",void 0),r([l(cc.Integer)],e.prototype,"hp",void 0),r([l(cc.Integer)],e.prototype,"damage",void 0),r([l(cc.Integer)],e.prototype,"speed",void 0),r([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Constant":"Constant"}],game:[function(t,e,o){"use strict";cc._RF.push(e,"a517eb+7thKDKRLBGvJAqVK","game");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Constant"),a=cc._decorator,s=a.ccclass,l=a.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameControl=null,e.crossHair=null,e.tower=null,e.golbinPrefab=null,e.trollPrefab=null,e.orcPrefab=null,e.renektonPrefab=null,e.shadow=null,e.shadowHurt=null,e.popupCard=null,e.endGame=null,e.linkToStore=null,e.textGuide=null,e.textGuide2=null,e.btnAtk=null,e.btnAtkSp=null,e.bgSound=null,e.clickSound=null,e.appearSound=null,e.endGameSound=null,e.efx_appear=null,e.efx_buff=null,e.efx_buff_atk=null,e.efx_upgrade=null,e.atkSpLabel=null,e.atkLabel=null,e.camera=null,e.lisSkillEquip=[],e.lisCardLock=[],e.selectSkillNode=null,e.btnStart=null,e.textUnlock=null,e.indexIsSelect=[{index:0,isEquip:!1,skillName:""},{index:0,isEquip:!1,skillName:""}],e.towerComp=null,e.totalEnemy=0,e.enemyDie=0,e.isEndGame=!1,e.isUpgrade=!1,e.countUpgrade=1,e.countUpgradeSp=1,e.isClick=!0,e}return i(e,t),e.prototype.onLoad=function(){cc.director.getCollisionManager().enabled=!0,this.shadow.parent.zIndex=3,this.tower.zIndex=2,cc.audioEngine.play(this.bgSound,!0,.5),this.makeResponsive()},e.prototype.selectSkill=function(t){var e=this,o=t.currentTarget,n=!1;this.indexIsSelect.forEach(function(t,i){if(!t.isEquip&&!n){cc.audioEngine.play(e.clickSound,!1,1.5),t.isEquip=!0,t.skillName=o.name,n=!0,o.getComponent(cc.Button).enabled=!1;var r=cc.instantiate(o);r.setPosition(e.lisSkillEquip[i].position),e.lisSkillEquip[i].parent.addChild(r),e.lisSkillEquip[i].children[0].active=!0,o.color=new cc.Color(129,129,129,255),o.children[0].active=!0,o.children[1].active=!1,1==i&&(e.selectSkillNode.getChildByName("handNode").active=!1,e.btnStart.active=!0)}})},e.prototype.onBattle=function(){var t=this;cc.audioEngine.play(this.clickSound,!1,1.5),cc.tween(this.selectSkillNode).to(.25,{opacity:0}).call(function(){cc.audioEngine.play(t.appearSound,!1,1.3),t.selectSkillNode.active=!1,t.efx_appear.node.active=!0,t.spawnEnemyTurn3(),t.indexIsSelect.forEach(function(e){switch(e.skillName){case"card_1":t.towerComp.upgrade1=!0;break;case"card_2":t.towerComp.upgrade2=!0;break;case"card_3":t.towerComp.upgrade3=!0;break;case"card_4":t.towerComp.upgrade4=!0}}),t.scheduleOnce(function(){t.tower.active=!0,t.addEventTouch(),t.textGuide.active=!0,t.crossHair.active=!0},1.25)}).start()},e.prototype.start=function(){this.towerComp=this.tower.getComponent("tower"),cc.Canvas.instance.node.on(c.Constant.EVENT.ENEMY_DIE,this.countEnemyDie,this),cc.Canvas.instance.node.on(c.Constant.EVENT.END_GAME,this.onEndGame,this),cc.Canvas.instance.node.on(c.Constant.EVENT.CHANGE_SPEED,this.changeSpeed,this),cc.Canvas.instance.node.on(c.Constant.EVENT.HURT_EFFECT,this.onHurt,this)},e.prototype.addEventTouch=function(){this.gameControl.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.gameControl.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.gameControl.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.gameControl.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},e.prototype.removeEventTouch=function(){this.gameControl.off(cc.Node.EventType.TOUCH_START),this.gameControl.off(cc.Node.EventType.TOUCH_MOVE),this.gameControl.off(cc.Node.EventType.TOUCH_END),this.gameControl.off(cc.Node.EventType.TOUCH_CANCEL)},e.prototype.onTouchStart=function(t){this.textGuide.active=!1,this.crossHair.children[0].active=!1;var e=this.gameControl.convertToNodeSpaceAR(t.getLocation());this.crossHair.setPosition(e),this.towerComp.attack()},e.prototype.onTouchMove=function(t){var e=this.gameControl.convertToNodeSpaceAR(t.getLocation());this.crossHair.setPosition(e)},e.prototype.onTouchEnd=function(){this.towerComp.idle()},e.prototype.changeSpeed=function(){var t=this;this.shadow.active=!1,this.btnAtkSp.getChildByName("hand").active=!1,this.textGuide.active=!1,this.btnAtkSp.children[0].getComponent(cc.Button).unscheduleAllCallbacks(),cc.audioEngine.play(this.clickSound,!1,1.5),this.towerComp.towerSkeleton.timeScale<=3.5&&(this.towerComp.towerSkeleton.timeScale+=.25,this.efx_buff.node.active=!0,this.efx_buff.setAnimation(0,"animation",!1),this.efx_buff.setCompleteListener(function(e){"animation"==e.animation.name&&(t.efx_buff.node.active=!1)}),this.countUpgradeSp++,this.atkSpLabel.string="Lv. "+this.countUpgradeSp,this.towerComp.towerSkeleton.timeScale),10==this.countUpgradeSp&&(this.onBtn(this.btnAtkSp,!1),this.atkSpLabel.string="Lv. Max")},e.prototype.showGuide=function(t){this.textGuide.active=!0,t.active=!0,t.getChildByName("hand").active=!0,this.onBtn(t,!0)},e.prototype.onBtn=function(t,e){t.children[0].active=e,t.children[1].active=!e,t.getChildByName("hand").active=e},e.prototype.onHurt=function(){cc.tween(this.shadowHurt).to(.1,{opacity:40}).to(.1,{opacity:0}).start()},e.prototype.upgradeTower=function(){var t=this;cc.audioEngine.play(this.clickSound,!1,1.5),this.btnAtk.getChildByName("hand").active=!1,this.textGuide.active=!1,this.efx_upgrade.play("upgrade_efx"),this.efx_buff_atk.node.active=!0,this.efx_buff_atk.setAnimation(0,"attack",!1),this.efx_buff_atk.setCompleteListener(function(e){"attack"==e.animation.name&&(t.efx_buff_atk.node.active=!1)}),this.countUpgrade++,1==this.countUpgrade?this.towerComp.turn2=!0:3==this.countUpgrade?this.tower.getChildByName("skill1").active=!0:5==this.countUpgrade?this.towerComp.skill2():7==this.countUpgrade&&this.towerComp.skill3(),15==this.countUpgrade?(this.onBtn(this.btnAtk,!1),this.atkLabel.string="Lv. Max"):this.atkLabel.string="Lv. "+this.countUpgrade},e.prototype.countEnemyDie=function(){var t=this;this.enemyDie++,10==this.enemyDie&&this.spawnEnemyTurn2(),this.enemyDie,75==this.enemyDie&&(this.btnStart.active=!1,this.textUnlock.active=!0,this.crossHair.active=!1,this.gameControl.active=!1,cc.tween(this.selectSkillNode).set({active:!0}).to(.25,{opacity:255}).call(function(){t.tower.active=!1,t.linkToStore.active=!0,t.lisSkillEquip[2].active=!0,t.lisSkillEquip[3].active=!0,t.selectSkillNode.getChildByName("handNode2").active=!0,t.lisCardLock.forEach(function(t){t.children[1].active=!0,t.children[0].active=!1,t.color=new cc.Color(255,255,255,255)})}).start())},e.prototype.changeSc2=function(){},e.prototype.onEndGame=function(t){this.isEndGame||(this.isEndGame=!0,this.shadow.active=!0,this.textGuide.active=!1,cc.tween(this.shadow).to(.25,{opacity:150}).start(),this.endGame.getChildByName(t?"win":"lose").active=!0,cc.audioEngine.play(this.endGameSound,!1,.5),t&&(this.towerComp.idle(),this.towerComp.unscheduleAllCallbacks(),this.tower.getChildByName("skill1").active=!1,this.towerComp.skill2Efx.active=!1),this.onBtn(this.btnAtk,!1),this.onBtn(this.btnAtkSp,!1),this.linkToStore.active=!0)},e.prototype.onCardPopup=function(){this.towerComp.idle(),this.shadow.active=!0,this.popupCard.active=!0,cc.tween(this.shadow).to(.25,{opacity:100}).start(),cc.tween(this.popupCard).to(.25,{scale:.4}).start()},e.prototype.selectCard=function(t,e){var o=this;switch(e){case"1":this.towerComp.upgrade1=!0;break;case"2":this.towerComp.upgrade2=!0;break;case"3":this.towerComp.upgrade3=!0,this.towerComp.skill2()}cc.audioEngine.play(this.clickSound,!1,1.5),this.towerComp.turn2=!0,this.towerComp.skill3(),cc.tween(this.shadow).delay(.1).to(.25,{opacity:0}).call(function(){o.shadow.active=!1,o.popupCard.active=!1,o.spawnEnemyTurn2()}).start(),cc.tween(this.popupCard).delay(.1).to(.25,{scale:0}).start()},e.prototype.spawnEnemyTurn1=function(){this.spawnEnemy(1,"golbin")},e.prototype.spawnEnemy=function(t,e){this.totalEnemy+=t;for(var o=0;o<t;o++){var n,i=Math.floor(-400*Math.random())+Math.floor(400*Math.random()),r=Math.floor(-500*Math.random())+Math.floor(500*Math.random()),c=Math.floor(2*Math.random())+1;n=o%2==0?cc.v3(i+20*o,c%2==0?-480:480):cc.v3(c%2==0?-400:400,r+20*o),this.createEnemy(e,n).getComponent("enemy").run()}},e.prototype.spawnEnemyTurn2=function(){this.spawnEnemy(10,"golbin")},e.prototype.spawnEnemyTurn3=function(){var t=this;this.spawnEnemy(30,"golbin"),this.scheduleOnce(function(){t.spawnEnemy(20,"orc")},4),this.scheduleOnce(function(){t.spawnEnemy(15,"troll")},8)},e.prototype.createEnemy=function(t,e){var o=null;switch(t){case"golbin":o=cc.instantiate(this.golbinPrefab);break;case"orc":o=cc.instantiate(this.orcPrefab);break;case"troll":o=cc.instantiate(this.trollPrefab);break;case"renekton":o=cc.instantiate(this.renektonPrefab)}return this.node.addChild(o),o.setPosition(e),o.scaleX=o.scaleX*(o.x<0?1:-1),o},e.prototype.update=function(){this.crossHair.x<0?this.towerComp.towerSkeleton.node.scaleX=-1:this.towerComp.towerSkeleton.node.scaleX=1},e.prototype.makeResponsive=function(){var t=this.node.getComponent(cc.Canvas),e=cc.view.getFrameSize(),o=t.designResolution.width/t.designResolution.height,n=e.width/e.height;n>=o?(t.fitHeight=!0,t.fitWidth=!1):n<o&&(t.fitHeight=!1,t.fitWidth=!0)},r([l(cc.Node)],e.prototype,"gameControl",void 0),r([l(cc.Node)],e.prototype,"crossHair",void 0),r([l(cc.Node)],e.prototype,"tower",void 0),r([l(cc.Prefab)],e.prototype,"golbinPrefab",void 0),r([l(cc.Prefab)],e.prototype,"trollPrefab",void 0),r([l(cc.Prefab)],e.prototype,"orcPrefab",void 0),r([l(cc.Prefab)],e.prototype,"renektonPrefab",void 0),r([l(cc.Node)],e.prototype,"shadow",void 0),r([l(cc.Node)],e.prototype,"shadowHurt",void 0),r([l(cc.Node)],e.prototype,"popupCard",void 0),r([l(cc.Node)],e.prototype,"endGame",void 0),r([l(cc.Node)],e.prototype,"linkToStore",void 0),r([l(cc.Node)],e.prototype,"textGuide",void 0),r([l(cc.Node)],e.prototype,"textGuide2",void 0),r([l(cc.Node)],e.prototype,"btnAtk",void 0),r([l(cc.Node)],e.prototype,"btnAtkSp",void 0),r([l(cc.AudioClip)],e.prototype,"bgSound",void 0),r([l(cc.AudioClip)],e.prototype,"clickSound",void 0),r([l(cc.AudioClip)],e.prototype,"appearSound",void 0),r([l(cc.AudioClip)],e.prototype,"endGameSound",void 0),r([l(sp.Skeleton)],e.prototype,"efx_appear",void 0),r([l(sp.Skeleton)],e.prototype,"efx_buff",void 0),r([l(sp.Skeleton)],e.prototype,"efx_buff_atk",void 0),r([l(cc.Animation)],e.prototype,"efx_upgrade",void 0),r([l(cc.Label)],e.prototype,"atkSpLabel",void 0),r([l(cc.Label)],e.prototype,"atkLabel",void 0),r([l(cc.Camera)],e.prototype,"camera",void 0),r([l(cc.Node)],e.prototype,"lisSkillEquip",void 0),r([l(cc.Node)],e.prototype,"lisCardLock",void 0),r([l(cc.Node)],e.prototype,"selectSkillNode",void 0),r([l(cc.Node)],e.prototype,"btnStart",void 0),r([l(cc.Node)],e.prototype,"textUnlock",void 0),r([s],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Constant":"Constant"}],rangeTowerListener:[function(t,e,o){"use strict";cc._RF.push(e,"a0240axJPBJNbF3quwdxHns","rangeTowerListener");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./tower"),a=t("./enemyListener"),s=cc._decorator,l=s.ccclass,p=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e.className=null,e}return i(e,t),e.prototype.start=function(){this.className=this.__classname__},e.prototype.onCollisionEnter=function(t){t.node.getComponent(a.default)&&t.node.getComponent(a.default).target&&(this.target.getComponent(c.default).enemyArr.push(t.node.getComponent(a.default).target),this.target.getComponent(c.default).attack())},e.prototype.onCollisionExit=function(t){t.node.getComponent(a.default)&&t.node.getComponent(a.default).target&&this.target.getComponent(c.default).removeEnemy(t.node.parent._id)},r([p(cc.Node)],e.prototype,"target",void 0),r([l],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./enemyListener":"enemyListener","./tower":"tower"}],towerListener:[function(t,e,o){"use strict";cc._RF.push(e,"97623AYZ0dKDL3YUx2BAnx8","towerListener");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.target=null,e}return i(e,t),e.prototype.start=function(){},e.prototype.onCollisionEnter=function(){},r([s(cc.Node)],e.prototype,"target",void 0),r([a],e)}(cc.Component);o.default=l,cc._RF.pop()},{}],tower:[function(t,e,o){"use strict";cc._RF.push(e,"7fcb4LgmJpEMJTHjOknkLzv","tower");var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),r=this&&this.__decorate||function(t,e,o,n){var i,r=arguments.length,c=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(c=(r<3?i(c):r>3?i(e,o,c):i(e,o))||c);return r>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Constant"),a=t("./bulletHeroListener"),s=cc._decorator,l=s.ccclass,p=s.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.towerSkeleton=null,e.towerBullet=null,e.towerBullet2=null,e.towerBulletSkill1=null,e.towerBulletSkill2=null,e.towerSpider=null,e.skill2Efx=null,e.bodyCollider=null,e.blood=null,e.atkSound=null,e.hp=500,e.damage=50,e.isDie=!1,e.maxHp=0,e.enemyArr=[],e.gamePlay=null,e.turn2=!1,e.isAttack=!1,e.upgrade1=!1,e.upgrade2=!1,e.upgrade3=!1,e.upgrade4=!1,e.onModeSpeed=!1,e}return i(e,t),e.prototype.start=function(){var t=this;this.idle(),this.maxHp=this.hp,this.gamePlay=cc.Canvas.instance.node.getComponent("game"),this.towerSkeleton.setEventListener(function(){t.shoot(),cc.audioEngine.play(t.atkSound,!1,.5),(t.onModeSpeed||t.turn2)&&t.shoot2()}),this.upgrade1&&this.skill2(),this.upgrade2&&this.skillSpider()},e.prototype.attack=function(){this.isAttack||(this.isAttack=!0,this.towerSkeleton.setAnimation(0,"attack_range",!0))},e.prototype.removeEnemy=function(t){var e=this;this.enemyArr.forEach(function(o,n){console.log(o._id),o._id==t&&e.enemyArr.splice(n,1)}),0==this.enemyArr.length&&this.idle()},e.prototype.skillSpider=function(){var t=this;this.schedule(function(){for(var e=0;e<11;e++){var o=cc.instantiate(t.towerSpider),n=-Math.PI+Math.PI*e/5,i=cc.v3(0,0);t.createBullet(o,n,i,5)}},3,cc.macro.REPEAT_FOREVER,.5)},e.prototype.skill2=function(){var t=this;this.schedule(function(){t.gamePlay.isEndGame||(t.skill2Efx.active=!0,t.skill2Efx.getComponent(cc.Animation).play("skill2Tower"),t.scheduleOnce(function(){t.skill2Efx.active=!1},2.4))},5,cc.macro.REPEAT_FOREVER,1)},e.prototype.skill3=function(){var t=this;this.schedule(function(){for(var e=function(e){var o=cc.instantiate(t.towerBulletSkill1),n=-Math.PI+Math.PI*e/5,i=cc.v3(0,0);o.angle=180*n/Math.PI+(t.towerSkeleton.node.scaleX<0?0:180),t.createBullet(o,n,i,2),t.scheduleOnce(function(){var o=cc.instantiate(t.towerBulletSkill2),n=-Math.PI+Math.PI*e/5,i=cc.v3(0,0);o.angle=180*n/Math.PI+(t.towerSkeleton.node.scaleX<0?0:180),t.createBullet(o,n,i,2)},.5)},o=0;o<11;o++)e(o)},4,cc.macro.REPEAT_FOREVER,.5)},e.prototype.skill4=function(t,e){for(var o=0;o<4;o++){var n=cc.instantiate(t);n.getComponent(a.default).isSkill4=!0;var i=3*-Math.PI/4+Math.PI*o/2;n.angle=180*i/Math.PI+(this.towerSkeleton.node.scaleX<0?0:180),this.createBullet(n,i,e,1)}},e.prototype.idle=function(){this.isAttack=!1,this.towerSkeleton.setAnimation(0,"idle",!0)},e.prototype.shoot=function(){for(var t=this.upgrade3?3:1,e=0;e<t;e++){var o=1==e?cc.instantiate(this.towerBullet2):cc.instantiate(this.towerBullet),n=this.towerSkeleton.node.scaleX<0?cc.v3(-33,43):cc.v3(33,43),i=this.checkAngle()+.25*e;this.createBullet(o,i,n)}},e.prototype.shoot2=function(){for(var t=0;t<1;t++){var e=cc.instantiate(this.towerBullet2),o=this.towerSkeleton.node.scaleX<0?cc.v3(-33,43):cc.v3(33,43),n=this.checkAngle()+.1;this.createBullet(e,n,o)}},e.prototype.createBullet=function(t,e,o,n){void 0===n&&(n=.5),this.node.parent.addChild(t),this.upgrade3&&t.getComponent("bulletHeroListener").setDame(100),t.setPosition(o);var i=this.towerSkeleton.node.scaleX<0?-1e3:1e3;cc.tween(t).to(n,{x:i*Math.cos(e),y:i*Math.sin(e)}).call(function(){t.destroy()}).start()},e.prototype.attacked=function(t){this.isDie||(this.hp-=t,this.hp<=0&&(this.hp=0,this.bodyCollider.enabled=!1,this.isDie=!0,this.node.stopAllActions(),this.node.getChildByName("skill1").active=!1,this.node.active=!1,this.unscheduleAllCallbacks(),cc.Canvas.instance.node.emit(c.Constant.EVENT.END_GAME,!1)),this.blood.fillRange=this.hp/this.maxHp,cc.Canvas.instance.node.emit(c.Constant.EVENT.HURT_EFFECT))},e.prototype.checkAngle=function(){var t=this.gamePlay.crossHair,e=0!==t.x?t.y/t.x:0;return Math.atan(e)},e.prototype.update=function(){},r([p(sp.Skeleton)],e.prototype,"towerSkeleton",void 0),r([p(cc.Prefab)],e.prototype,"towerBullet",void 0),r([p(cc.Prefab)],e.prototype,"towerBullet2",void 0),r([p(cc.Prefab)],e.prototype,"towerBulletSkill1",void 0),r([p(cc.Prefab)],e.prototype,"towerBulletSkill2",void 0),r([p(cc.Prefab)],e.prototype,"towerSpider",void 0),r([p(cc.Node)],e.prototype,"skill2Efx",void 0),r([p(cc.CircleCollider)],e.prototype,"bodyCollider",void 0),r([p(cc.Sprite)],e.prototype,"blood",void 0),r([p(cc.AudioClip)],e.prototype,"atkSound",void 0),r([p(cc.Integer)],e.prototype,"hp",void 0),r([p(cc.Integer)],e.prototype,"damage",void 0),r([l],e)}(cc.Component);o.default=d,cc._RF.pop()},{"./Constant":"Constant","./bulletHeroListener":"bulletHeroListener"}]},{},["Constant","bulletHeroListener","AdManager","PlatformBrandIcon","destinationListener","effect","enemy","enemyListener","game","rangeTowerListener","tower","towerListener"]);